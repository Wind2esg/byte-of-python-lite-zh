# 运算符与表达式 operators and expressions {#op-exp}

大多数你写的语句都含有**表达式**。`2 + 3` 就是个简单的表达式。表达式可以拆分为运算符 (operator) 和操作数 (operand) 。

**运算符**是具有某些功能的，它的形式可以是符号如 `+` ，或者特殊关键词。运算符需要有数据去运算，这些数据称为**操作数**。

## 运算符 operators

我们可以先简单看看运算符和它们的使用方法。

你看，你能使用互动解释器命令行来计算例子中给出的表达式。例如，试试  `2 + 3` ：

```python
>>> 2 + 3
5
>>> 3 * 5
15
>>>
```

运算符快速一览表：

- `+` （加）
    - `'a' + 'b'` 得到 `'ab'` ，。
    > python 中当操作数是字符串式，`+` 可以省略，即 `'a''b'` 得到 `'ab'`
- `-` （减）

- `*` （乘）
    - `2 * 3` 得到 `6` 。 `'la' * 3` 得到 `'lalala'` 。

- `**` （幂）
    - 返回 x 的 y 次幂
    - `3 ** 4` 得到 `81` （即 `3 * 3 * 3 * 3` ）。

- `/` （除）
    - `13 / 3` 得出 `4.333333333333333`

- `//` （除取整）
    - x 被 y 除，并且取结果的整数部分作为答案。请注意，如果其中某个值是浮点数，那么你就会得到浮点数的结果。 
    - `13 // 3` 得出 `4`
    - `9//1.81` 得出 `4.0`

- `%` （模）
    - 返回除的余数
    - `13 % 3` 得出 `1` 。 `-25.5 % 2.25` 得出 `1.5` 。

- `<<` （左移位）
    - 将数字的二进制位向左移动若干位（每一个数字在内存中都是使用二进制数 0 或 1 表示）。
    - `2 << 2` 得出 `8` 。 `2` 的二进制数是 `10` 。左移位 2 位得出 `1000` 即 `8` 。

- `>>` （右移位）

- `&` （按位与）
    - 将数字的二进制数对应位想比较，同为 1 则那一位结果为 1 ，否则为 0 。
    - `5 & 3` gives `1`.

- `|` （按位或）
    - 将数字的二进制数对应位想比较，同为 0 则那一位结果为 0 ，否则为 1 。
    - `5 | 3` gives `7`

- `^` （按位异或）
    - 将数字的二进制数对应位想比较，这两位相同则那一位结果为 0 ，否则为 1 。
    - `5 ^ 3` gives `6`

- `~` （按位取反）
    - x 的按位翻转得到的是 -(x+1) ，0 变为。
    - `~5` 得出 `-6` 。http://stackoverflow.com/a/11810203 能够给你更多关于 `~` 的信息。

- `<` （小于）

- `>` （大于）

- `<=` （小于等于）

- `>=` （大于等于）

- `==` （等于）

- `=` （赋值）
    - 将又侧的值赋给左侧的变量。
    > 注意它和 `==` 的区别。

- `!=` （不等于）

- `not` （布尔 非）
    - 如果 x 是 `True` ，返回 `False` 。 如果 x is `False` ，返回 `True` 。

- `and` （布尔 与）
    - `x and y` x 和 y 都为 `True` 时，返回 `True` 否则为 `False` 。
    - 如果 python 发现表达式左侧是 `False` ，那么它就不会看右侧。这叫做短路计算。

- `or` (布尔 或）
    - x 与 y 皆为 `False` 时，返回 `False` 否则为 `True` 。
    - `x = True; y = False; x or y` 返回 `True` 。或同样运用了短路计算。

## 数学运算符同赋值符的简写

对某个变量使用数学运算符并且将运算结果再赋值给这个变量实在太常见了，因此对于此类表达式有了如下的简写：

```python
a = 2
a = a * 3
```

可写作：

```python
a = 2
a *= 3
```

请注意，`var = var operation expression` 变成了 `var operation= expression` 。

## 计算顺序 evaluation order

如 `2 + 3 * 4` 这类表达式，是先加还是先乘？高中数学告诉我们会先做乘。也就是说，乘运算符比加运算符拥有更高的优先级 (precedence) 。

下表给出了 python 中的优先级表，优先级从低到高。在给定的表达式中，python 会优先计算表中位置更靠后的运算符和表达式。

下表取自 [Python reference manual](http://docs.python.org/3/reference/expressions.html#operator-precedence) 。为了显式明确的指定优先级，你最好使用括号来明确运算符和操作数分组。这会增加程序的可读性。之后的[改变计算顺序](#changing-order-of-evaluation)章节会有更详细的描述

- `lambda` : Lambda 表达式
- `if - else` : 条件表达式
- `or` : 布尔或
- `and` : 布尔与
- `not x` : 布尔非
- `in, not in, is, is not, <, <=, >, >=, !=, ==` : 比较
- `|` : 按位或
- `^` : 按位异或
- `&` : 按位与
- `<<, >>` : 移位
- `+, -` : 加，减
- `*, /, //, %` : 乘，除，除取整，模
- `+x, -x, ~x` : 正，负，按位取反
- `**` : 幂
- `x[index], x[index:index], x(arguments...), x.attribute` : 下标 (Subscription) ，切片 (slicing) ，调用，属性引用
- `(expressions...), [expressions...], {key: value...}, {expressions...}` : 绑定或元组 (tuple) 显示，列表显示，字典显示，集合显示

我们尚未讲解到的运算符会在之后的章节中解释。

**优先级相同** 的运算符在上表中位列同一行规。例如 `+` 和 `-` 就有着相同的的优先级。

## 改变计算顺序 {#changing-order-of-evaluation}

为了使表达式的可读性更好，我们使用括号。例如，`2 + (3 * 4)` 就很容易理解不像 `2 + 3 * 4` 那样需要运算符优先级的知识。如其他事物，括号应适度使用，不要像 `(2 + (3 * 4))` 这般冗余。

括号还有另一种妙用--它能帮助我们改变计算的顺序。例如如果你想要先计算加，你可以这样写 `(2 + 3) * 4` 。

## 结合性 associativity

通常运算符从左至右结合。也就是说相同优先级的运算符会以从左至右的顺序来计算。例如，`2 + 3 + 4` 会被当做  `(2 + 3) + 4` 来计算。

## 表达式

请看示例 `expression.py` :

```python
length = 5
breadth = 2

area = length * breadth
print('Area is', area)
print('Perimeter is', 2 * (length + breadth))
```

输出为:

```
$ python expression.py
Area is 10
Perimeter is 14
```

**它怎样做的**

长方形的长和宽分别以 `length` 和 `breadth` 变量储存。我们通过表达式来使用他们，以计算该长方形的面积和周长。我们将结果使用表达式 `length * breadth` 储存正在变量 `area` 中，然后将他们使用 `print` 函数打印到屏幕。在第二个例子中，我们在 `print` 函数中直接使用表达式 `2 * (length + breadth)` 的值。

另外，请注意 python 会**美化**输出。尽管我们并未指定 `'Area is'` 和变量 `area` 之间的存在一个空格，python 会为我们放置它，以期我们能得到更干净整齐的输出同时程序的可读性也会更高（由于我们不需考虑用于输出的字符串中的空格。这仅仅是 python 使我们的编程生活变得更简单的例子中的一个。

## 总结

我们弄明白了怎样使用运算符，操作数和表达式--他们是程序的基本。接下来我们将看到它们如何在我们程序的语句之中充分发挥作用。